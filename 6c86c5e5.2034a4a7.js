(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{162:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return b})),n.d(t,"default",(function(){return c}));var r=n(2),a=n(6),o=(n(0),n(254)),i={id:"runtime-API",title:"Runtime API",sidebar_label:"Runtime API"},l={id:"version-4.x/editor-flow/runtime-API",title:"Runtime API",description:"Yoshi Editor Flow provides runtime helpers for developing OOI apps.",source:"@site/versioned_docs/version-4.x/editor-flow/runtime-API.md",permalink:"/yoshi/docs/editor-flow/runtime-API",editUrl:"https://github.com/wix/yoshi/edit/master/website/versioned_docs/version-4.x/editor-flow/runtime-API.md",version:"4.x",lastUpdatedBy:"yanivefraim",lastUpdatedAt:1591802067,sidebar_label:"Runtime API",sidebar:"version-4.x/editor-flow",previous:{title:"Component Level",permalink:"/yoshi/docs/editor-flow/structure-api/component"},next:{title:"Local Development",permalink:"/yoshi/docs/editor-flow/local-development"}},b=[{value:"<code>WixSDK</code>",id:"wixsdk",children:[]},{value:"<code>BILogger</code>",id:"bilogger",children:[]},{value:"<code>flowAPI</code>",id:"flowapi",children:[{value:"Sentry",id:"sentry",children:[]},{value:"Fedops",id:"fedops",children:[]},{value:"isSSR",id:"isssr",children:[]},{value:"isMobile",id:"ismobile",children:[]},{value:"getSiteLanguage",id:"getsitelanguage",children:[]},{value:"getExperiments",id:"getexperiments",children:[]}]}],p={rightToc:b};function c(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Yoshi Editor Flow provides runtime helpers for developing OOI apps.\nIt happens on 2 different layers:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"providing runtime helpers via ",Object(o.b)("inlineCode",{parentName:"li"},"yoshi-flow-editor-runtime"),"."),Object(o.b)("li",{parentName:"ul"},"extending platform API's with additional utils specified for each environment (viewer script, editor script)")),Object(o.b)("h1",{id:"yoshi-flow-editor-rutime"},Object(o.b)("inlineCode",{parentName:"h1"},"yoshi-flow-editor-rutime")),Object(o.b)("p",null,"It exports various Higher Order Components (HOCs) and methods to reduce boilerplate on client's side and organize the app structure in a better way."),Object(o.b)("h2",{id:"wixsdk"},Object(o.b)("inlineCode",{parentName:"h2"},"WixSDK")),Object(o.b)("p",null,"WixSDK is a HOC that loads ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/wix-private/fed-infra/blob/master/js-sdk-wrapper/src/types.ts"}),"IStaticWix")," object."),Object(o.b)("p",null,"It renders a ",Object(o.b)("inlineCode",{parentName:"p"},"children")," function with ",Object(o.b)("inlineCode",{parentName:"p"},"sdk")," argument:"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"sdk"),": ",Object(o.b)("inlineCode",{parentName:"p"},"{ Wix: IWixStatic | null }")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-tsx"}),'import { WixSDK } from "yoshi-flow-editor-runtime";\n\nexport default () => (\n  <WixSDK>\n    {sdk => <SomeComp Wix={sdk.Wix} /> // IStaticWix | null\n    }\n  </WixSDK>\n);\n')),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"sdk.Wix")," will be ",Object(o.b)("inlineCode",{parentName:"p"},"null")," if ",Object(o.b)("inlineCode",{parentName:"p"},"WixSDK")," is being used in Widget part and rendered in Viewer mode, so make sure you are checking if it's not ",Object(o.b)("inlineCode",{parentName:"p"},"null")," to use it."),Object(o.b)("h4",{id:"props"},"Props"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"isEditor")," - should be passed for Settings part. It triggers a ",Object(o.b)("inlineCode",{parentName:"p"},"WixSDK"),", so it will use strict types for ",Object(o.b)("inlineCode",{parentName:"p"},"sdk.Wix")," and it won't be ",Object(o.b)("em",{parentName:"p"},"optional"),"."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Settings.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-tsx"}),'import { WixSDK } from "yoshi-flow-editor-runtime";\n\nexport default () => (\n  <WixSDK isEditor>\n    {sdk => <SomeComp Wix={sdk.Wix} /> // IStaticWix\n    }\n  </WixSDK>\n);\n')),Object(o.b)("h2",{id:"bilogger"},Object(o.b)("inlineCode",{parentName:"h2"},"BILogger")),Object(o.b)("p",null,"Currently it consists of ",Object(o.b)("inlineCode",{parentName:"p"},"BILoggerProvider")," and ",Object(o.b)("inlineCode",{parentName:"p"},"BILogger")," components."),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"BILoggerProvider")," should be rendered in the root of you component and receive a ",Object(o.b)("inlineCode",{parentName:"p"},"biLogger")," prop."),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"BILogger")," is a consumer. It will render a ",Object(o.b)("inlineCode",{parentName:"p"},"children")," function with ",Object(o.b)("inlineCode",{parentName:"p"},"biLogger")," passed to provider."),Object(o.b)("p",null,"You still need to create and configure ",Object(o.b)("inlineCode",{parentName:"p"},"biLogger")," instance, so it's just an attempt to remove some boilerplate from your side."),Object(o.b)("p",null,"To configure biLogger instance, you have to follow ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/wix-private/fed-handbook/blob/master/BI.md#overview"}),"fed-handbook BI section steps"),"."),Object(o.b)("p",null,"By loading schema logger you've initialized and registered, you should use different loggers according to runtime environment:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Settings panel: ",Object(o.b)("inlineCode",{parentName:"li"},"iframeAppBiLoggerFactory")," imported from ",Object(o.b)("inlineCode",{parentName:"li"},"@wix/iframe-app-bi-logger")," package"),Object(o.b)("li",{parentName:"ul"},"Widget: ",Object(o.b)("inlineCode",{parentName:"li"},"@wix/web-bi-logger")," package")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Settings.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-tsx"}),'import { WixSDK, BILogger, BILoggerProvider } from "yoshi-flow-editor-runtime";\nimport { iframeAppBiLoggerFactory } from "@wix/iframe-app-bi-logger";\nimport initSchemaLogger from "your-schema-logger-package";\n\nconst biLogger = initSchemaLogger(iframeAppBiLoggerFactory);\n\n// Root component\nexport default () => (\n  <BILoggerProvider logger={biLogger}>\n    // Settings content...\n    <ColorPicker />\n  </BILoggerProvider>\n);\n\n// Somewhere deeper in the component\nconst ColorPicker = () => (\n  <BiLogger>\n    {biLogger => (\n      <ColorPickerColorSpace\n        onChange={() => {\n          logger.logColorChange();\n        }}\n      />\n    )}\n  </BiLogger>\n);\n')),Object(o.b)("h1",{id:"extended-platform-apis"},"Extended platform API's"),Object(o.b)("p",null,"To reduce boilerplate for platform entities (viewer controller, editor script), we are providing additional utilities.\nThe main goal is to preserve platform API's and make it more convenient for day-to-day use-cases."),Object(o.b)("h2",{id:"flowapi"},Object(o.b)("inlineCode",{parentName:"h2"},"flowAPI")),Object(o.b)("p",null,"To extend platform API's editor flow passes an additional value to platform methods.\nThis value is an object called ",Object(o.b)("inlineCode",{parentName:"p"},"flowAPI"),". It's already configured for:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"app level. ",Object(o.b)("inlineCode",{parentName:"li"},"flowAPI")," will be passed for ",Object(o.b)("inlineCode",{parentName:"li"},"initAppForPage")," and editor script methods from ",Object(o.b)("inlineCode",{parentName:"li"},"editor.app.ts"),". (",Object(o.b)("inlineCode",{parentName:"li"},"editorReady"),", ",Object(o.b)("inlineCode",{parentName:"li"},"getManifest"),", etc)"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"component level:")," ",Object(o.b)("inlineCode",{parentName:"li"},"flowAPI")," will be a field for user's ",Object(o.b)("inlineCode",{parentName:"li"},"controller.ts"),".")),Object(o.b)("p",null,"In this section we'll go through instances and helpers ",Object(o.b)("inlineCode",{parentName:"p"},"flowAPI")," provides. In practice, ",Object(o.b)("inlineCode",{parentName:"p"},"flowAPI")," is not a single instance. Its shape will vary according to consumer's environment:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"editor.app.ts"),": ",Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/wix/yoshi/blob/master/packages/yoshi-flow-editor-runtime/src/FlowAPI.ts#L91"}),Object(o.b)("inlineCode",{parentName:"a"},"EditorScriptFlowAPI"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"viewer.app.ts"),": ",Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/wix/yoshi/blob/master/packages/yoshi-flow-editor-runtime/src/FlowAPI.ts#L137"}),Object(o.b)("inlineCode",{parentName:"a"},"ViewerScriptFlowAPI"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"controller.ts"),": ",Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/wix/yoshi/blob/master/packages/yoshi-flow-editor-runtime/src/FlowAPI.ts#L43"}),Object(o.b)("inlineCode",{parentName:"a"},"ControllerFlowAPI")))),Object(o.b)("h3",{id:"sentry"},"Sentry"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Available for ",Object(o.b)("inlineCode",{parentName:"em"},"viewer.app.ts"),", ",Object(o.b)("inlineCode",{parentName:"em"},"editor.app.ts")," and ",Object(o.b)("inlineCode",{parentName:"em"},"controller"),".")),Object(o.b)("p",null,"Open-source error tracking tool that helps developers monitor and fix crashes in real time. You can head to ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://docs.sentry.io/"}),"the official documentation")," for better understanding of Sentry's capabilities, API and configuration."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"All unhandled errors in ",Object(o.b)("inlineCode",{parentName:"strong"},"Widget"),", ",Object(o.b)("inlineCode",{parentName:"strong"},"Settings"),", ",Object(o.b)("inlineCode",{parentName:"strong"},"controller"),", ",Object(o.b)("inlineCode",{parentName:"strong"},"viewer.app.ts"),", ",Object(o.b)("inlineCode",{parentName:"strong"},"editor.app.ts")," are being logged automatically"),"."),Object(o.b)("p",null,"Each log event has different ",Object(o.b)("inlineCode",{parentName:"p"},"environment")," according to the context an error appeared:"),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Error Context"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Logger Environment"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("strong",{parentName:"td"},"Widget")," in viewer"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Viewer")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("strong",{parentName:"td"},"Widget")," in editor"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Editor")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("strong",{parentName:"td"},"Settings")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Editor")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("strong",{parentName:"td"},"controller")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Viewer:Worker")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("strong",{parentName:"td"},"viewer.app")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Viewer:Worker")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("strong",{parentName:"td"},"editor.app")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Editor:Worker")))),Object(o.b)("p",null,"For example, if the error will appear in ",Object(o.b)("em",{parentName:"p"},"controller.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"export default ({ flowAPI }) => {\n  // This error is being logged by the Editor Flow\n  throw new Error('Ooh, oops \ud83e\udd74');\n\n  try {\n    // This error is being logged by user\n    throw new Error('Ooh, oops \ud83e\udd74);\n  } catch (e) {\n    flowAPI.reportError(e);\n  }\n};\n")),Object(o.b)("p",null,"It will be logged under ",Object(o.b)("inlineCode",{parentName:"p"},"Viewer:Worker")," environment.\n",Object(o.b)("img",Object(r.a)({parentName:"p"},{src:"https://user-images.githubusercontent.com/11733036/84033045-f0eac280-a9a0-11ea-80dc-2770e60af399.png",alt:"sentry-search"})),"\n",Object(o.b)("img",Object(r.a)({parentName:"p"},{src:"https://user-images.githubusercontent.com/11733036/84033054-f3e5b300-a9a0-11ea-82f3-5c45f8667aed.png",alt:"sentry-error-row"}))),Object(o.b)("h4",{id:"sentrymonitor"},Object(o.b)("inlineCode",{parentName:"h4"},"sentryMonitor")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Available for ",Object(o.b)("inlineCode",{parentName:"em"},"viewer.app.ts"),", ",Object(o.b)("inlineCode",{parentName:"em"},"editor.app.ts")," and ",Object(o.b)("inlineCode",{parentName:"em"},"controller"),".")),Object(o.b)("p",null,"Provides a ",Object(o.b)("inlineCode",{parentName:"p"},"Raven")," or ",Object(o.b)("inlineCode",{parentName:"p"},"Sentry Browser Client")," instances according to the environment it's consumed. To prevent increasing a bundle, we're just taking the monitor passed by the platform. We create an instance which is specifically configured for your app and environment and pass it as a ",Object(o.b)("inlineCode",{parentName:"p"},"flowAPI")," property."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"controller.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),'export default ({ flowAPI }) => {\n  try {\n    doSomethingDangerouseButNotVeryImportant();\n  } catch (e) {\n    flowAPI.sentryMonitor.captureMessage(\n      "Something not important is not working."\n    );\n  }\n};\n')),Object(o.b)("h4",{id:"reporterror"},Object(o.b)("inlineCode",{parentName:"h4"},"reportError")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Available for ",Object(o.b)("inlineCode",{parentName:"em"},"viewer.app.ts"),", ",Object(o.b)("inlineCode",{parentName:"em"},"editor.app.ts")," and ",Object(o.b)("inlineCode",{parentName:"em"},"controller"),".")),Object(o.b)("p",null,"It's a shorthand for ",Object(o.b)("inlineCode",{parentName:"p"},"sentryMonitor.captureException"),". Since this method is the main part of sentry interaction use-cases, we providing it as a separate method."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"controller.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"export default ({ flowAPI }) => {\n  try {\n    doSomethingDangerouseAndVeryImportant();\n  } catch (e) {\n    flowAPI.reportError(e); // the same as `flowAPI.sentryMonitor.captureException(e);`\n  }\n};\n")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"editor.app.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"export const editorReady: EditorReadyFn = async (\n  editorSDK, // platform\n  appDefinitionId, // platform\n  platformOptions, // platform\n  flowAPI // editor flow\n) => {\n  if (platformOptions.firstInstall) {\n    try {\n      installApp();\n    } catch (e) {\n      flowAPI.reportError(e);\n    }\n  }\n};\n")),Object(o.b)("h3",{id:"fedops"},"Fedops"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Available for ",Object(o.b)("inlineCode",{parentName:"em"},"editor.app.ts")," and ",Object(o.b)("inlineCode",{parentName:"em"},"controller"),".")),Object(o.b)("p",null,"A javascript library to allow realtime monitoring, following the 'fedops' methodology."),Object(o.b)("p",null,"After you initialize the app via ",Object(o.b)("inlineCode",{parentName:"p"},"create-yoshi-app"),", integrated it with lifecycle and pushed to the github, a ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://grafana.wixpress.com/login"}),"grafana")," dashboard will be created automatically for your app."),Object(o.b)("p",null,"Boards for each component will be configured also."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},Object(o.b)("inlineCode",{parentName:"strong"},"appLoadStarted")," and ",Object(o.b)("inlineCode",{parentName:"strong"},"appLoaded")," events will be logged automatically by the Editor Flow."),"\nMoreover, both client-side rendering and server-side rendering logs for Widget are covered. So for most cases you don't need to handle fedops logs by yourself at all."),Object(o.b)("h4",{id:"fedopslogger"},Object(o.b)("inlineCode",{parentName:"h4"},"fedopsLogger")),Object(o.b)("p",null,"Provides a ",Object(o.b)("inlineCode",{parentName:"p"},"Fedops BaseLogger")," initialized for current environment. Logs from ",Object(o.b)("inlineCode",{parentName:"p"},"editor.app.ts")," will be available for editor script board, ",Object(o.b)("inlineCode",{parentName:"p"},"controller")," - for component's board."),Object(o.b)("p",null,"For more info relared to fedopsLogger API, please ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/wix-private/fed-infra/tree/master/fedops/fedops-logger"}),"follow this link")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"controller.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"// appLoadStarted and appLoaded already covered by the editor flow \ud83d\ude0c\nexport default ({ flowAPI }) => {\n  const handleSubmitSomething = () => {\n    flowAPI.fedopsLogger.interactionStarted(SUBMIT_SOMETHING_FEDOPS_INTERACTION);\n    // process the action...\n    flowAPI.fedopsLogger.interactionEnded(SUBMIT_SOMETHING_FEDOPS_INTERACTION);\n  };\n\n  return {\n    pageReady() {\n      setProps({\n        handleSubmitSomething,\n      });\n    }\n  };\n};\n")),Object(o.b)("h3",{id:"isssr"},"isSSR"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Available for the ",Object(o.b)("inlineCode",{parentName:"em"},"controller"),".")),Object(o.b)("p",null,"A helper that returns ",Object(o.b)("inlineCode",{parentName:"p"},"true")," if current rendering environment is a server-side-rendering. Returns ",Object(o.b)("inlineCode",{parentName:"p"},"false")," in case of client-side-rendering.\n",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://bo.wix.com/wix-docs/client/viewer-platform---ooi/about/get-started/guidelines#viewer-platform---ooi_about_get-started_guidelines_overview"}),"Read more about SSR and CRS")," for viewer platform."),Object(o.b)("h3",{id:"ismobile"},"isMobile"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Available for the ",Object(o.b)("inlineCode",{parentName:"em"},"controller"),".")),Object(o.b)("p",null,"A helper that returns ",Object(o.b)("inlineCode",{parentName:"p"},"true")," if window's form factor is a mobile."),Object(o.b)("h3",{id:"getsitelanguage"},"getSiteLanguage"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Available for the ",Object(o.b)("inlineCode",{parentName:"em"},"controller"),".")),Object(o.b)("p",null,"If multilingual is enabled, returns current language for it. If not, returns a site language. Will use a fallback language if nothing found."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"controller.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"export default async function({ flowAPI }) => {\n  return {\n    pageReady() {\n      const language = flowAPI.getSiteLanguage();\n      const translations = getSiteTranslations(language);\n\n      // ...\n    }\n  };\n}\n")),Object(o.b)("h3",{id:"getexperiments"},"getExperiments"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"Available for ",Object(o.b)("inlineCode",{parentName:"em"},"viewer.app.ts"),", ",Object(o.b)("inlineCode",{parentName:"em"},"editor.app.ts")," and ",Object(o.b)("inlineCode",{parentName:"em"},"controller"),".")),Object(o.b)("p",null,"Returns a ",Object(o.b)("inlineCode",{parentName:"p"},"Promise"),", which will be resolved with ",Object(o.b)("inlineCode",{parentName:"p"},"Experiments")," instance for current app's scope."),Object(o.b)("p",null,"To read more about experiments API, ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/wix-private/fed-infra/tree/master/experiments/wix-experiments"}),"check Experiments page")),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"getExperiments")," won't trigger a fetch process for your experiments. To optimize performance, it's already triggered under the hood before method execution.\nSo technically ",Object(o.b)("inlineCode",{parentName:"p"},"getExperiments")," just returns a pending or resolved ",Object(o.b)("inlineCode",{parentName:"p"},"Promise"),"."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"controller.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"export default async function({ flowAPI }) => {\n  return {\n    pageReady() {\n      const experiments = await flowAPI.getExperiments();\n      setProps({\n        withNewButton: experiments.enabled('specs.my-scope.EnableNewButton'),\n      });\n    }\n  };\n}\n")),Object(o.b)("p",null,"Parallel loading example to improve your controller performance:"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"controller.ts")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-ts"}),"export default async function createController({ flowData }) => {\n  return {\n    pageReady() {\n      const [experiments, someData] = await Promise.all([\n        flowData.getExperiments(),\n        getSomeData(),\n      ]);\n      setProps({\n        withNewButton: experiments.enabled('specs.my-scope.EnableNewButton'),\n        someData,\n      });\n    }\n  };\n}\n")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"We are currently working on implementing more runtime helpers")))}c.isMDXComponent=!0},254:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=a.a.createContext({}),c=function(e){var t=a.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l({},t,{},e)),n},s=function(e){var t=c(e.components);return a.a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=Object(r.forwardRef)((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,p=b(e,["components","mdxType","originalType","parentName"]),s=c(n),m=r,u=s["".concat(i,".").concat(m)]||s[m]||d[m]||o;return n?a.a.createElement(u,l({ref:t},p,{components:n})):a.a.createElement(u,l({ref:t},p))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var b in t)hasOwnProperty.call(t,b)&&(l[b]=t[b]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);