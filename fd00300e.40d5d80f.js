(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{223:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return b})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return r})),n.d(t,"default",(function(){return c}));var i=n(2),a=(n(0),n(229));const b={id:"legacy-flow",title:"Legacy Flow",sidebar_label:"Legacy Flow"},l={id:"version-4.x/legacy-flow",title:"Legacy Flow",description:"## CLI",source:"@site/versioned_docs/version-4.x/legacy-flow.md",permalink:"/yoshi/docs/legacy-flow",editUrl:"https://github.com/wix/yoshi/edit/master/website/versioned_docs/version-4.x/legacy-flow.md",version:"4.x",lastUpdatedBy:"Ran Yitzhaki",lastUpdatedAt:1589296391,sidebar_label:"Legacy Flow",sidebar:"version-4.x/docs",previous:{title:"Business-Manager Flow",permalink:"/yoshi/docs/business-manager-flow"},next:{title:"Getting Started",permalink:"/yoshi/docs/yoshi-server/getting-started"}},r=[{value:"CLI",id:"cli",children:[{value:"Global options",id:"global-options",children:[]},{value:"start",id:"start",children:[]},{value:"build",id:"build",children:[]},{value:"test",id:"test",children:[]},{value:"lint",id:"lint",children:[]},{value:"release",id:"release",children:[]}]},{value:"Configuration",id:"configuration",children:[]}],o={rightToc:r};function c({components:e,...t}){return Object(a.b)("wrapper",Object(i.a)({},o,t,{components:e,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"cli"},"CLI"),Object(a.b)("h3",{id:"global-options"},"Global options"),Object(a.b)("h4",{id:"--help---h-"},Object(a.b)("inlineCode",{parentName:"h4"},"--help")," ( ",Object(a.b)("inlineCode",{parentName:"h4"},"-h")," )"),Object(a.b)("p",null,"Output usage information"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"./dist/index.js")),Object(a.b)("h4",{id:"--verbose"},Object(a.b)("inlineCode",{parentName:"h4"},"--verbose")),Object(a.b)("p",null,"Yoshi will print verbose logs and error messages."),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"true")," in CI"),Object(a.b)("h3",{id:"start"},"start"),Object(a.b)("p",null,"This will run the specified (server) ",Object(a.b)("inlineCode",{parentName:"p"},"entryPoint")," file and mount a CDN server."),Object(a.b)("h4",{id:"options"},"options"),Object(a.b)("h5",{id:"--entry-point---e-"},Object(a.b)("inlineCode",{parentName:"h5"},"--entry-point")," ( ",Object(a.b)("inlineCode",{parentName:"h5"},"-e")," ) ",Object(a.b)("img",{src:"https://img.shields.io/badge/deprecated-yellow"})),Object(a.b)("p",null,"Entry point for the app."),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"index.js")),Object(a.b)("h5",{id:"--server"},Object(a.b)("inlineCode",{parentName:"h5"},"--server")," ",Object(a.b)("img",{src:"https://img.shields.io/badge/deprecated-yellow"})),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"An alias for ",Object(a.b)("inlineCode",{parentName:"p"},"entry-point")," configuration option.")),Object(a.b)("p",null,"Entry point for the app server. Supported only by ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"/yoshi/docs/app-flow"}),"app flow"),"."),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"index.js")),Object(a.b)("h5",{id:"--manual-restart"},Object(a.b)("inlineCode",{parentName:"h5"},"--manual-restart")),Object(a.b)("p",null,"Get SIGHUP on change and manage application reboot manually"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"false")),Object(a.b)("h5",{id:"--with-tests"},Object(a.b)("inlineCode",{parentName:"h5"},"--with-tests")),Object(a.b)("p",null,"Spawn ",Object(a.b)("inlineCode",{parentName:"p"},"npm test")," after start"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"false")),Object(a.b)("h5",{id:"--no-server"},Object(a.b)("inlineCode",{parentName:"h5"},"--no-server")),Object(a.b)("p",null,"Do not spawn the app server"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"false")),Object(a.b)("h5",{id:"--debug"},Object(a.b)("inlineCode",{parentName:"h5"},"--debug")),Object(a.b)("p",null,"Allow server debugging, debugger will be available at 127.0.0.1:","[port]"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"0")),Object(a.b)("h5",{id:"--debug-brk"},Object(a.b)("inlineCode",{parentName:"h5"},"--debug-brk")),Object(a.b)("p",null,"Allow server debugging, debugger will be available at 127.0.0.1:","[port]",", process won't start until debugger will be attached"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"0")),Object(a.b)("h5",{id:"--production"},Object(a.b)("inlineCode",{parentName:"h5"},"--production")),Object(a.b)("p",null,"Start using unminified production build (the tests would not run in this mode)"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"0")),Object(a.b)("p",null,"The following are the default values for the CDN server's port, mount directory and whether to serve statics over https or regular http. You can change them in your ",Object(a.b)("inlineCode",{parentName:"p"},"package.json"),":"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-json"}),'"yoshi": {\n  "servers": {\n    "cdn": {\n      "port": 3200,\n      "dir": "dist/statics",\n      "ssl": false\n    }\n  }\n}\n')),Object(a.b)("h5",{id:"--url"},Object(a.b)("inlineCode",{parentName:"h5"},"--url")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"Similar to the ",Object(a.b)("inlineCode",{parentName:"p"},"startUrl")," configuration option. If both are specified ",Object(a.b)("inlineCode",{parentName:"p"},"--url")," will be used.")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"Note: You can disable browser opening functionality by using ",Object(a.b)("inlineCode",{parentName:"p"},"BROWSER=none")," env variable.")),Object(a.b)("p",null,"Opens the browser on a supplied url, also supports multiple urls separated by comma."),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"http://localhost:3000")),Object(a.b)("h3",{id:"build"},"build"),Object(a.b)("h4",{id:"options-1"},"options"),Object(a.b)("h5",{id:"--analyze"},Object(a.b)("inlineCode",{parentName:"h5"},"--analyze")),Object(a.b)("p",null,"run webpack-bundle-analyzer plugin."),Object(a.b)("h5",{id:"--stats"},Object(a.b)("inlineCode",{parentName:"h5"},"--stats")),Object(a.b)("p",null,"output webpack stats file to ",Object(a.b)("inlineCode",{parentName:"p"},"dist/webpack-stats.json")," (see also ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"/yoshi/docs/legacy-guides/bundle-analyze"}),"bundle analysis"),")|"),Object(a.b)("h5",{id:"--source-map"},Object(a.b)("inlineCode",{parentName:"h5"},"--source-map")),Object(a.b)("p",null,"Explicitly emit bundle source maps."),Object(a.b)("p",null,"This task will perform the following:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Compile using ",Object(a.b)("inlineCode",{parentName:"li"},"TypeScript")," (",Object(a.b)("inlineCode",{parentName:"li"},"*.ts"),") or ",Object(a.b)("inlineCode",{parentName:"li"},"babel")," (",Object(a.b)("inlineCode",{parentName:"li"},"*.js"),") files into ",Object(a.b)("inlineCode",{parentName:"li"},"dist/"),"."),Object(a.b)("li",{parentName:"ol"},"Copy assets to ",Object(a.b)("inlineCode",{parentName:"li"},"dist")," folder (ejs/html/images...).")),Object(a.b)("p",null,"You can specify multiple entry points in your ",Object(a.b)("inlineCode",{parentName:"p"},"package.json")," file. This gives the ability build multiple bundles at once. More info about Webpack entries can be found ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"http://webpack.github.io/docs/configuration.html#entry"}),"here"),"."),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-json"}),'"yoshi": {\n  "entry": {\n    "a": "./a",\n    "b": "./b",\n    "c": ["./c", "./d"]\n  }\n}\n')),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Note:")," if you have multiple entries you should consider using the ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"https://gist.github.com/sokra/1522d586b8e5c0f5072d7565c2bee693"}),Object(a.b)("inlineCode",{parentName:"a"},"optimization.splitChunks"))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Note2:")," the decision whether to use ",Object(a.b)("inlineCode",{parentName:"p"},"TypeScript")," or ",Object(a.b)("inlineCode",{parentName:"p"},"babel")," is done by searching ",Object(a.b)("inlineCode",{parentName:"p"},"tsconfig.json")," inside the root directory."),Object(a.b)("h3",{id:"test"},"test"),Object(a.b)("p",null,"Executes tests using ",Object(a.b)("inlineCode",{parentName:"p"},"jest")," as default."),Object(a.b)("h4",{id:"options-2"},"options"),Object(a.b)("h5",{id:"--jest"},Object(a.b)("inlineCode",{parentName:"h5"},"--jest")),Object(a.b)("p",null,"Run tests with Jest - this is the default"),Object(a.b)("h5",{id:"--mocha"},Object(a.b)("inlineCode",{parentName:"h5"},"--mocha")),Object(a.b)("p",null,"Run unit tests with Mocha"),Object(a.b)("p",null,"You can set environment variable ",Object(a.b)("inlineCode",{parentName:"p"},"MOCHA_TIMEOUT")," to set the timeout for mocha tests.\ndefaults to 30000ms"),Object(a.b)("h5",{id:"--jasmine"},Object(a.b)("inlineCode",{parentName:"h5"},"--jasmine")),Object(a.b)("p",null,"Run unit tests with Jasmine"),Object(a.b)("h5",{id:"--karma"},Object(a.b)("inlineCode",{parentName:"h5"},"--karma")),Object(a.b)("p",null,"Run tests with Karma (browser)"),Object(a.b)("h5",{id:"--protractor"},Object(a.b)("inlineCode",{parentName:"h5"},"--protractor")),Object(a.b)("p",null,"Run e2e tests with Protractor (e2e)"),Object(a.b)("h5",{id:"--watch"},Object(a.b)("inlineCode",{parentName:"h5"},"--watch")),Object(a.b)("p",null,"Run tests on watch mode (works for mocha, jasmine, jest & karma)"),Object(a.b)("h5",{id:"--debug-1"},Object(a.b)("inlineCode",{parentName:"h5"},"--debug")),Object(a.b)("p",null,"Allow test debugging (works for mocha, jest & protractor)"),Object(a.b)("h5",{id:"--debug-brk-1"},Object(a.b)("inlineCode",{parentName:"h5"},"--debug-brk")),Object(a.b)("p",null,"Allow test debugging (works for mocha, jest & protractor), process won't start until debugger will be attached"),Object(a.b)("h5",{id:"--coverage"},Object(a.b)("inlineCode",{parentName:"h5"},"--coverage")),Object(a.b)("p",null,"Collect and output code coverage"),Object(a.b)("h4",{id:"examples"},"Examples"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Jest test setup:"),Object(a.b)("p",{parentName:"li"},"Every other argument you'll pass to ",Object(a.b)("inlineCode",{parentName:"p"},"yoshi test")," will be forwarded to jest, For example:"),Object(a.b)("p",{parentName:"li"},Object(a.b)("inlineCode",{parentName:"p"},"yoshi test --forceExit foo.spec.js")),Object(a.b)("p",{parentName:"li"},"Will run jest on ",Object(a.b)("inlineCode",{parentName:"p"},"foo.spec.js")," file and will apply ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"https://jestjs.io/docs/en/cli#forceexit"}),Object(a.b)("inlineCode",{parentName:"a"},"forceExit")),"."),Object(a.b)("p",{parentName:"li"},Object(a.b)("strong",{parentName:"p"},"Note:")," ",Object(a.b)("inlineCode",{parentName:"p"},"--debug & --debug-brk")," won't be transfer to jest, but instead will be ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"https://jestjs.io/docs/en/troubleshooting#tests-are-failing-and-you-don-t-know-why"}),"used in yoshi for test debugging"))),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Mocha tests setup:"),Object(a.b)("p",{parentName:"li"},"You can add a ",Object(a.b)("inlineCode",{parentName:"p"},"test/mocha-setup.js")," file, with mocha tests specific setup. Mocha will ",Object(a.b)("inlineCode",{parentName:"p"},"require")," this file, if exists.\nExample for such ",Object(a.b)("inlineCode",{parentName:"p"},"test/mocha-setup.js"),":"),Object(a.b)("pre",{parentName:"li"},Object(a.b)("code",Object(i.a)({parentName:"pre"},{className:"language-js"}),'import "babel-polyfill";\nimport "isomorphic-fetch";\nimport sinonChai from "sinon-chai";\nimport chaiAsPromised from "chai-as-promised";\nimport chai from "chai";\n\nchai.use(sinonChai);\nchai.use(chaiAsPromised);\n'))),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Karma tests setup:"),Object(a.b)("p",{parentName:"li"},"When running tests using Karma, make sure you have the right configurations in your ",Object(a.b)("inlineCode",{parentName:"p"},"package.json")," as described in ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"#wixspecs"}),Object(a.b)("inlineCode",{parentName:"a"},"yoshi.specs"))," section. In addition, if you have a ",Object(a.b)("inlineCode",{parentName:"p"},"karma.conf.js")," file, the configurations will be merged with our ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"yoshi/config/karma.conf.js"}),"built-in configurations"),".")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Jasmine tests setup:"),Object(a.b)("p",{parentName:"li"},"Specifying a custom glob for test files is possible by configuring ",Object(a.b)("inlineCode",{parentName:"p"},"package.json")," as described in ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"#wixspecs"}),Object(a.b)("inlineCode",{parentName:"a"},"yoshi.specs")),". The default glob matches ",Object(a.b)("inlineCode",{parentName:"p"},".spec.")," files in all folders."),Object(a.b)("p",{parentName:"li"},"If you wish to load helpers, import them all in a file placed at ",Object(a.b)("inlineCode",{parentName:"p"},"'test/setup.js'"),"."))),Object(a.b)("h3",{id:"lint"},"lint"),Object(a.b)("h4",{id:"options-3"},"options"),Object(a.b)("h5",{id:"--fix"},Object(a.b)("inlineCode",{parentName:"h5"},"--fix")),Object(a.b)("p",null,"Automatically fix lint problems"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"false")),Object(a.b)("h5",{id:"--format"},Object(a.b)("inlineCode",{parentName:"h5"},"--format")),Object(a.b)("p",null,"Use a specific formatter for eslint/tslint"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"stylish")),Object(a.b)("h5",{id:"files"},Object(a.b)("inlineCode",{parentName:"h5"},"[files...]")),Object(a.b)("p",null,"Optional list of files (space delimited) to run lint on"),Object(a.b)("p",null,"Default: empty"),Object(a.b)("p",null,"Executes linters based on the project type:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(i.a)({parentName:"li"},{href:"https://palantir.github.io/tslint/"}),Object(a.b)("inlineCode",{parentName:"a"},"TSLint"))," for TypeScript projects (a ",Object(a.b)("inlineCode",{parentName:"li"},"tslint.json")," configuration file is required)"),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(i.a)({parentName:"li"},{href:"https://eslint.org/"}),Object(a.b)("inlineCode",{parentName:"a"},"ESLint"))," for Babel projects (an ",Object(a.b)("inlineCode",{parentName:"li"},".eslintrc")," configuration file is required)")),Object(a.b)("h3",{id:"release"},"release"),Object(a.b)("h4",{id:"options-4"},"options"),Object(a.b)("h5",{id:"--minor"},Object(a.b)("inlineCode",{parentName:"h5"},"--minor")),Object(a.b)("p",null,"bump a minor version instead of a patch"),Object(a.b)("p",null,"Default: ",Object(a.b)("inlineCode",{parentName:"p"},"false")),Object(a.b)("p",null,"Bump the patch version in ",Object(a.b)("inlineCode",{parentName:"p"},"package.json")," using ",Object(a.b)("inlineCode",{parentName:"p"},"wnpm-release"),". --\x3e"),Object(a.b)("h2",{id:"configuration"},"Configuration"),Object(a.b)("p",null,"The legacy flow is using ",Object(a.b)("a",Object(i.a)({parentName:"p"},{href:"/yoshi/docs/yoshi-config"}),"yoshi-config")))}c.isMDXComponent=!0},229:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return j}));var i=n(0),a=n.n(i);function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},b=Object.keys(e);for(i=0;i<b.length;i++)n=b[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(i=0;i<b.length;i++)n=b[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=a.a.createContext({}),p=function(e){var t=a.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):r({},t,{},e)),n},s=function(e){var t=p(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=Object(i.forwardRef)((function(e,t){var n=e.components,i=e.mdxType,b=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),s=p(n),d=i,j=s["".concat(l,".").concat(d)]||s[d]||u[d]||b;return n?a.a.createElement(j,r({ref:t},c,{components:n})):a.a.createElement(j,r({ref:t},c))}));function j(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var b=n.length,l=new Array(b);l[0]=d;var r={};for(var o in t)hasOwnProperty.call(t,o)&&(r[o]=t[o]);r.originalType=e,r.mdxType="string"==typeof e?e:i,l[1]=r;for(var c=2;c<b;c++)l[c]=n[c];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);