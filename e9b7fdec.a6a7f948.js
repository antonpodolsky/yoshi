(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{239:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return p})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return s}));var a=n(2),i=n(6),r=(n(0),n(259)),o={id:"application",title:"Application Level",sidebar_label:"Application Level"},p={id:"version-4.x/editor-flow/structure-api/application",title:"Application Level",description:"## App configuration",source:"@site/versioned_docs/version-4.x/editor-flow/structure-api/application.md",permalink:"/yoshi/docs/editor-flow/structure-api/application",editUrl:"https://github.com/wix/yoshi/edit/master/website/versioned_docs/version-4.x/editor-flow/structure-api/application.md",version:"4.x",lastUpdatedBy:"Artem Yavorsky",lastUpdatedAt:1593027768,sidebar_label:"Application Level",sidebar:"version-4.x/editor-flow",previous:{title:"Structure Overview",permalink:"/yoshi/docs/editor-flow/structure-api/overview"},next:{title:"Component Level",permalink:"/yoshi/docs/editor-flow/structure-api/component"}},l=[{value:"App configuration",id:"app-configuration",children:[{value:"<code>.application.json</code>",id:"applicationjson",children:[]}]},{value:"Viewer and Editor Script entries",id:"viewer-and-editor-script-entries",children:[{value:"<code>viewer.app.ts</code>",id:"viewerappts",children:[]},{value:"<code>editor.app.ts</code>",id:"editorappts",children:[]}]},{value:"Assets",id:"assets",children:[{value:"Locales",id:"locales",children:[]}]}],c={rightToc:l};function s(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"app-configuration"},"App configuration"),Object(r.b)("h3",{id:"applicationjson"},Object(r.b)("inlineCode",{parentName:"h3"},".application.json")),Object(r.b)("p",null,"Each app should contain ",Object(r.b)("inlineCode",{parentName:"p"},".application.json")," in the project's root:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'{\n  "appDefinitionId": "YOUR_APP_DEFINITION_ID",\n  "appName": "Your app name",\n  "sentry": {\n    DSN: "https://e255c968aa1143f08fc02e9243b66136@o283065.ingest.sentry.io/1510555",\n    id: "SENTRY_ID",\n    teamName: "some-team",\n    projectName: "some-project"\n  },\n  "translations: {\n    "default": "en"\n  },\n  "experiments": {\n    "scope": "test"\n  }\n}\n')),Object(r.b)("p",null,"The content will be auto-generated by ",Object(r.b)("inlineCode",{parentName:"p"},"create-yoshi-app"),"."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"appDefinitionId")," - App definition id of you app in app service."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"appName")," - App's name in app service."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"sentry")," - Automatically configured object according to the ",Object(r.b)("inlineCode",{parentName:"li"},"team name")," you've selected. ",Object(r.b)("inlineCode",{parentName:"li"},"projectName")," will be the same as an app's artifact name."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"experiments"),": Configuration object for current experiments scope. After generation it's mocked with ",Object(r.b)("inlineCode",{parentName:"li"},"test")," scope, which should be updated or removed before publishing app to production."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"translations"),": Configuration object for using locales.",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"default")," (",Object(r.b)("inlineCode",{parentName:"li"},"Boolean"),"): fallback language to use in case of errors while fetching any other language.")))),Object(r.b)("h2",{id:"viewer-and-editor-script-entries"},"Viewer and Editor Script entries"),Object(r.b)("p",null,"Sometimes you want to have the code common for all components. Platform provides ",Object(r.b)("inlineCode",{parentName:"p"},"initAppForPage")," handler for Viewer Script, which is being initialized before controllers created.\nFor the editor part, you can maintain the Editor Script.\nThere're entry-points for viewer and editor scripts allowing you to use platform methods. So we are providing ",Object(r.b)("inlineCode",{parentName:"p"},"viewer.app.ts")," and ",Object(r.b)("inlineCode",{parentName:"p"},"editor.app.ts")," concept."),Object(r.b)("p",null,"To add it to the project, just create a file under ",Object(r.b)("inlineCode",{parentName:"p"},"src")," directory:"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"touch src/viewer.app.ts")," or ",Object(r.b)("inlineCode",{parentName:"p"},"touch src/editor.app.ts")),Object(r.b)("h3",{id:"viewerappts"},Object(r.b)("inlineCode",{parentName:"h3"},"viewer.app.ts")),Object(r.b)("p",null,"Entry point for Viewer Script file."),Object(r.b)("h4",{id:"initappforpage"},Object(r.b)("inlineCode",{parentName:"h4"},"initAppForPage")),Object(r.b)("p",null,"A general call to the service where it should initiate its reusable data across components.\nIt's called with the basic configuration of the application before the Viewer knows which components exist on the page."),Object(r.b)("p",null,"Any data returned in ",Object(r.b)("inlineCode",{parentName:"p"},"initAppForPage")," will be passed to each controller as an ",Object(r.b)("inlineCode",{parentName:"p"},"appData")," value."),Object(r.b)("p",null,"\u26a0\ufe0f You shouldn't use ",Object(r.b)("inlineCode",{parentName:"p"},"createControllers"),". We will generate it under the hood."),Object(r.b)("p",null,Object(r.b)("em",{parentName:"p"},"src/viewer.app.ts")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"export const initAppForPage = async (\n  initParams,\n  platformApis,\n  wixCodeApi,\n  platformServicesApis,\n  flowAPI\n) => {\n  // Init some fake storage common for all widgets\n  const kitchen = initKitchen();\n  const omelette = kitchen.cook('omlette');\n  \n  // will be passed as an `appData.omelette` for each controller\n  return {\n    omelette,\n  };\n};\n")),Object(r.b)("p",null,"Returned data will be passed to all controllers.\n",Object(r.b)("em",{parentName:"p"},"src/components/SomeWidget/controller.ts")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"export default ({ appData }) => {\n  // Do something with data received from `initAppForPage`...\n  const { omelette } = appData;\n\n  return {\n    pageReady() {\n      setProps({\n        // Pass it to the Widget if needed\n        omelette,\n      });\n    }\n  };\n};\n")),Object(r.b)("p",null,"For more info related to ",Object(r.b)("inlineCode",{parentName:"p"},"initAppForPage")," check the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://bo.wix.com/wix-docs/client/client-viewer-platform/articles/lifecycle#client-viewer-platform_articles_lifecycle_initappforpage"}),"Viewer platform official docs")),Object(r.b)("h3",{id:"editorappts"},Object(r.b)("inlineCode",{parentName:"h3"},"editor.app.ts")),Object(r.b)("p",null,"Entry point for Editor Script file."),Object(r.b)("p",null,"We are preserving the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://bo.wix.com/wix-docs/client/editor-platform/editor-application-reference/editor-platform-app"}),"Editor Script API"),", but adding ",Object(r.b)("inlineCode",{parentName:"p"},"flowAPI")," with useful helpers as a last argument.",Object(r.b)("br",{parentName:"p"}),"\n","It provides already initialized ",Object(r.b)("inlineCode",{parentName:"p"},"sentryMonitor")," and ",Object(r.b)("inlineCode",{parentName:"p"},"fedopsLogger")," objects, ",Object(r.b)("inlineCode",{parentName:"p"},"reportError")," helper function and ",Object(r.b)("inlineCode",{parentName:"p"},"getExperiments")," accessor. For more info about flowAPI, please read ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"./component#flowapi"}),"Component Level page")),Object(r.b)("p",null,Object(r.b)("em",{parentName:"p"},"src/editor.app.ts")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"export const editorReady = async (\n  editorSDK,\n  appDefinitionId,\n  platformOptions,\n  flowAPI\n) => {\n  const platform = new AppPlatform(editorSDK, appDefinitionId);\n\n  if (platformOptions.firstInstall) {\n    await platform.install();\n  } else {\n    await platform.hackForTemplates();\n  }\n};\n\nexport const getAppManifest = async () => {\n  return getManifest();\n};\n")),Object(r.b)("h2",{id:"assets"},"Assets"),Object(r.b)("p",null,"A place for static files like images, fonts, translations."),Object(r.b)("h3",{id:"locales"},"Locales"),Object(r.b)("p",null,"Directory where all locales are located. Editor flow will expect all locales to be named as ",Object(r.b)("inlineCode",{parentName:"p"},"messages_:LANGUAGE"),".\nFollowing the naming convention will help editor flow to locate needed locale files and load it w/o asking user to set up a provider and just directly use\n",Object(r.b)("inlineCode",{parentName:"p"},"translate")," HOC in your Widget or Settings panel. For more info, check ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/yoshi/docs/editor-flow/runtime-api/yoshi-flow-editor-runtime#translate"}),Object(r.b)("inlineCode",{parentName:"a"},"translate")," docs")))}s.isMDXComponent=!0},259:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=i.a.createContext({}),s=function(e){var t=i.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):p({},t,{},e)),n},b=function(e){var t=s(e.components);return i.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),b=s(n),u=a,m=b["".concat(o,".").concat(u)]||b[u]||d[u]||r;return n?i.a.createElement(m,p({ref:t},c,{components:n})):i.a.createElement(m,p({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=u;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:a,o[1]=p;for(var c=2;c<r;c++)o[c]=n[c];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);